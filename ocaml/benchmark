#!/bin/bash
cd tests
rm -r -f temp
mkdir -p temp
cd temp

function run {
  for f in $1
  do
    base=`basename $f`

    ../../bin/confsolve-semantics-bytecode $f &> /dev/null;

    if [ $? -ne 0 ]; then
      echo ""
      echo "FAILED"
    else
      time `../../bin/confsolve-semantics-bytecode $f &> ${base%.*}.mzn
      mzn2fzn --no-optimize --no-output-ozn ${base%.*}.mzn &> /dev/null; 
      fz -time 3000 ${base%.*}.fzn &> /dev/null;`
    fi
    
    echo ${base%.*}
    
  done
}

run "../*.spec"
run "../../examples/*.spec"